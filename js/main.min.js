!function(e){"use strict";function t(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function o(e,t){var o=n(e,t)?i:a;o(e,t)}var n,a,i;"classList"in document.documentElement?(n=function(e,t){return e.classList.contains(t)},a=function(e,t){e.classList.add(t)},i=function(e,t){e.classList.remove(t)}):(n=function(e,o){return t(o).test(e.className)},a=function(e,t){n(e,t)||(e.className=e.className+" "+t)},i=function(e,o){e.className=e.className.replace(t(o)," ")});var r={hasClass:n,addClass:a,removeClass:i,toggleClass:o,has:n,add:a,remove:i,toggle:o};"function"==typeof define&&define.amd?define(r):e.classie=r}(window),String.prototype.repeat=function(e){return new Array(Math.round(e)+1).join(this)},function(e){e.fn.addSliderSegments=function(){return this.each(function(){var t=e(this),o=t.slider("option"),n=(o.max-o.min)/o.step,a=o.orientation;if("vertical"===a){var i,r="";for(i=1;n-1>=i;i+1)r+='<div class="ui-slider-segment" style="top:'+100/n*i+'%;"></div>';t.prepend(r)}else{var l=100/n+"%",s='<div class="ui-slider-segment" style="margin-left: '+l+';"></div>';t.prepend(s.repeat(n-1))}})},jQuery(function(e){var t=e("#slider"),o=e("#walk-slider"),n=15,a=100;e(document).on("click",'a[href="#fakelink"]',function(e){e.preventDefault()}),e('[data-toggle="select"]').length&&e('[data-toggle="select"]').select2({minimumResultsForSearch:-1}),t.length>0&&t.slider({min:1,max:4,value:2,orientation:"horizontal",range:"min",slide:function(e,o){var a=o.value*n;t.find(".ui-slider-value:last").text(a+" 分鐘").data("slidervalue",a)}}).addSliderSegments(t.slider("option").max),e(".btn-group").on("click","a",function(){e(this).siblings().removeClass("active").end().addClass("active")}),o.length>0&&o.slider({min:2,max:9,value:6,orientation:"horizontal",range:"min",slide:function(e,t){var n=t.value*a;o.find(".ui-slider-value:last").text(n+" 公尺").data("slidervalue",n)}}).addSliderSegments(o.slider("option").max),e('[data-toggle="checkbox"]').radiocheck(),e('[data-toggle="radio"]').radiocheck(),e('[data-toggle="switch"]').length&&e('[data-toggle="switch"]').bootstrapSwitch()})}(jQuery),function(e){var t=e("#slider"),o=e("#walk-slider"),n={fromtime:e("#select-form-time")},a=e("#article-conveyance"),i=(e("#wrapper"),e("#footer"),600),r=30;e(function(e){window.alert=swal,e(".iui-overlay").find(".btn-close").on("click",function(){classie.addClass(document.getElementById("overlay"),"hidden"),GMap.initialize(function(){e(window).resize(function(e){google.maps.event.trigger(GMap.map,"resize")}),google.maps.event.addListener(GMap.map,"idle",function(){GMap.centerMarker.setPosition(GMap.map.getCenter()),GMap.centerCircle.setCenter(GMap.centerMarker.getPosition())}),google.maps.event.addListener(GMap.infowindow,"dragstart",function(e){GMap.infowindow.close()}),google.maps.event.addListener(GMap.centerMarker,"drag",function(e){GMap.centerCircle.setCenter(GMap.centerMarker.getPosition())}),google.maps.event.addListener(GMap.map,"idle",function(){TripTaipeiService.getStops(GMap.map.getCenter().lat(),GMap.map.getCenter().lng(),i,"BYTM",GMap.addStops),TripTaipeiService.getTripArea(GMap.map.getCenter().lat(),GMap.map.getCenter().lng(),i,r,1,"0800","YMBT",GMap.addGeoJson)}),google.maps.event.addListener(GMap.centerMarker,"dragend",function(e){TripTaipeiService.getStops(GMap.centerMarker.getPosition().lat(),GMap.centerMarker.getPosition().lng(),i,"BYTM",GMap.addStops),TripTaipeiService.getTripArea(GMap.centerMarker.getPosition().lat(),GMap.centerMarker.getPosition().lng(),i,r,1,"0800","YMBT",GMap.addGeoJson)}),google.maps.event.addListener(GMap.centerCircle,"radius_changed",function(){TripTaipeiService.getStops(GMap.centerMarker.getPosition().lat(),GMap.centerMarker.getPosition().lng(),i,"BYTM",GMap.addStops),TripTaipeiService.getTripArea(GMap.centerMarker.getPosition().lat(),GMap.centerMarker.getPosition().lng(),i,r,1,"0800","YMBT",GMap.addGeoJson)})})});var l=e("#weekly").find(".btn").on("click",function(){console.log(e(this).text())});e(l[(new Date).getDay()]).click(),a.find('[data-toggle="checkbox"]').on("change.radiocheck",function(t){var o=e(this);console.log(o.prop("id"),o.prop("checked"))}),o.on("slidestop",function(e,t){i=o.find(".ui-slider-value:last").data("slidervalue"),GMap.centerCircle.setOptions({radius:i})}),t.on("slidestop",function(e,o){r=t.find(".ui-slider-value:last").data("slidervalue")}),e("#menu-close").click(function(o){o.preventDefault(),e("#sidebar-wrapper").toggleClass("active");var a="搭乘時間: "+t.find(".ui-slider-value:last").data("slidervalue");a+="\n開始時間: "+n.fromtime.val(),console.log(a)}),e("#menu-toggle").click(function(t){t.preventDefault(),e("#sidebar-wrapper").toggleClass("active")}),e(".iui-overlay").find(".btn-close").click()})}(jQuery),function(){"use strict";function e(e,t){this.controlUI=document.createElement("div"),this.controlUI.style.backgroundColor="#fff",this.controlUI.style.border="2px solid #fff",this.controlUI.style.borderRadius="3px",this.controlUI.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",this.controlUI.style.cursor="pointer",this.controlUI.style.marginTop="15px",this.controlUI.style.textAlign="center",this.controlUI.title="顯示您的位置",this.controlText=document.createElement("div"),this.controlText.style.color="rgb(25,25,25)",this.controlText.style.fontSize="14px",this.controlText.style.lineHeight="22px",this.controlText.style.paddingLeft="5px",this.controlText.style.paddingRight="5px",this.controlText.innerHTML="定位",this.controlUI.appendChild(this.controlText),e.appendChild(this.controlUI),this.controlUI.addEventListener("click",function(){c()})}var t=[],o=new google.maps.Data,n=new google.maps.Data,a=new google.maps.Data,i={map:{},centerMarker:{},centerCircle:{},infowindow:{}};i.initialize=function(t){var o=this,n={zoom:13,disableDefaultUI:!0,scrollwheel:!1,center:new google.maps.LatLng(25.04775,121.517371),mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_CENTER}};o.map=new google.maps.Map(document.getElementById("map-canvas"),n),c();var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAGtUlEQVRoQ9WaX2wc1RWHzz333DvrXa8nbiJiBV6oVLUvtA/lISgBFCSkUAmp6gsSgof2qby1qA9EQFoQAlIJoUoVkCKVIlWqqgqaZIkdx3Y6m7B2jXeN7YRKVVOjktjeXa/t8TqO/83cW53xLN0aB0jEGO2VRnf2zqzmfOf8zr3nzq6AFm+ixe2HRAEezv1zDywtQe7Ru2tJOSpRgMfy0/WFWiW7UpmbpHTGKCctnFTKSinBISE0SRv1Eq0ihBQJQYiWUIBAwc0KECAkCCHQghDwydzywvzi8g/+9PC3I6ckCvCTQtmfrVbc5StTVqWzoDIdIpVJW00StJJCE1ruHYXxGEZQmhA08TmDSXAkigDATtfXVq9W/AdeP3jH3xsRTRTgiaGyf7Vcda9PTRun3QXKZNFpazMoBBAhakVGa4EpIqO0AC0JUySM1gSaBGoigxJhwQBeW90w85WlHx0/0HWyWY6JAvz8g4p/+WrZXS1Xwcm6oDNZUKkUCImgEAEJgD2sHYKUFMCGO1F0EEAirALCCghwwEB1auGJNw/ue2NrLiUKcKRY9S99MuNuzM4ZnXXBac8iaW0kG68ESkSjNCERGkUCFBECChNIBCsJSaFxwGL5yvzLv79335HtJoJEAZ7/cNYf+Xja9Ss143Z+AzLZDiStDEkAKQmR0ERZK9CAFIA8RNKQJiCSqBFgYcb/4/H9ex+/0SyWKMCvx2v+hX9PufPVeXA6OsHJZkETgSTBAFFPioA05wSBlvLTcyUR6pXF/r3Lex761SHO4e1bogC/uVjz+y9PuYtzdZNyO8HJZJAkGiT2sEClyZAUKDWZTeNlJCcpUdRr9Yu0ZA+8dui2a5+3huwIQH3xukkzQDqNSMIoGXkdSZKRWqCWZEjLSDYMwNP73MzCX966p+uRL1oAEwU4Nl7zC5NT7vLyOqR3dYJOpQClAMUaVwLkFtkQ8YoFYKwBYQBqVxdeefv+fb/42iLw3OisX/rPjLu2Fpi2XZ2gHI0kpSElIfI8sYQkSi2MIgJEgdaCsaGFwBp0jIGliv/kG/fd8erXkgNPFav+P66U3cBAJCHiKVNJI5XgZI5gpJaoSRqOjLWA1lpjjAUTGgwCYzuFsYvz1x797cHb/7zj0+jPhiv+5EzFtYIg7e7iJAWpJHApQVKAjFZcCZIwsi00FiC0ENoQghAgDA2EGwHsRRtMVesP/uHBO70dXch+OlT2pytVV+qUaevogIa3aXO6RCnJKCW5sjDWGjAG0BhrIsPDEMPAmiAwsLERYnsYLFbrK/e989A3J3aslPhxYcafm511U+1ZcLLtwBUnJyrnAPdKIZeZLB2IZGMYwm56PjAQBCHEAAwBsLY+vbiytP/sD++6siPF3OPnpxf9+bmsVGrdaUtZRUIgcbnMEMghYMULGwmfJWSECTc/BKERnAMxSHQebITCrAf/IpM+0PPYt+qJl9OvvXvm4uXLkxl/93e/V9uzZ9Npuxu+2w3xCPxvtzO3eTHutuq9Maw6Zla8Q4ei1TnRdeDEX08UJz76qP3oM09/54sWpFu9nijAqROnimOXGOBIiwKcOlUcm2hhgFwuVxwbv9T+bKtGoKfndLFYmmhdgDNnzhRHih+2LkD/2bPFweFS+9FnWzSJBwb6hwuDI27LAgwNDXl9/V5XywIMD3/g9fYNdLXsOlAqlbzTPWdbF2B0dNR7r7u3dQHGx8e9k7nuVgaY8E7mTrcywE1HgItL3l82F5kWAPhoND7n6/z6JdlyerQ06r3X86VzQAIAAYCKIRqGR++JeMscE/A4j/FhEy2nR0ZKXk/vl5qF2HANACkAYBBuDYBmEIbgjQz3DBAmCjA8POz19p37vBzg57PHHQBoi43nsa3G82c2eg0A1mOISFaJAkQr8YB3IwB+NnudDWfPM0izziOJNB0MwMavAMDGjmzqC4WCN3Du/HalBCdqw3juG7LZTjrNEmL5NKKQfATOn7/geXkG+L89MRvbkAyDsGfZo42ZZmvfmHEa4437oyAkKqF8Pu/lLww2S4iTleXCsuFnr8YHe7Z5qrzRHv8z9yQKMDBwznu/MNj1y6PP8KaeNc6Gp2Nj2fjrzXq+lTcTiQL09Q14hUKhK5c7eVepVMrG3ufk5ERcjmeTW7H70+8kCtDb2+v9LX9h38svvrA/9jzrl73+lRifeA50d3fn8+8P3n7sxRfuj2WzFHv/hr953Ww4Eo3A8eO/K01Ofrz32LGXvh97nr3fKAlu1tZt708U4PDhw/eMjY055XKZ/xrAi1BUgH2V7b/X+vVRV1C3fgAAAABJRU5ErkJggg==",i=new google.maps.LatLng(25.0372264,121.506378);o.centerMarker=new google.maps.Marker({draggable:!0,position:i,map:o.map,icon:a});var r=document.createElement("div");new e(r,o.map);r.index=1,o.map.controls[google.maps.ControlPosition.TOP_CENTER].push(r),o.centerCircle=new google.maps.Circle({strokeColor:"#2980B9",strokeOpacity:.8,strokeWeight:2,fillColor:"#3498DB",fillOpacity:.1,map:o.map,center:o.map.getCenter(),radius:600,zIndex:999}),o.infowindow=new google.maps.InfoWindow({}),t&&"function"==typeof t&&t()};var r=function(e){var t=new google.maps.LatLng(parseFloat(e.coords.latitude),parseFloat(e.coords.longitude));i.map.setCenter(t)},l=function(e){r(e)},s=function(e){switch(e.code){case 1:console.error("錯誤!應用程式沒有權限使用定位服務!");break;case 2:console.error("錯誤!取得位址資料時發生錯誤!");break;case 3:console.error("錯誤!超過等待時間...");break;default:console.error("不明錯誤...")}},c=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(l,s):console.error("錯誤!不支援定位服務!")},p=function(e,t){var o=e;o.addListener("click",function(){infowindow.setOptions({content:t}),infowindow.open(i.map,o)})},d=function(e){switch(e){case"Stop":if(t){for(var i=t.length-1;i>=0;i--)t[i].setMap(null);t.length=0}break;case"GeoJson":o.forEach(function(e){o.remove(e)}),a.forEach(function(e){a.remove(e)}),n.forEach(function(e){n.remove(e)})}};i.addStops=function(e){if(d("Stop"),e.result.length>0)for(var o=e.result.length-1;o>=0;o--){var n=null;"B"===e.result[o].type?n="#f39c12":"M"===e.result[o].type?n="#16a085":"T"===e.result[o].type&&(n="#c0392b");var a=new google.maps.Marker({icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:n,fillOpacity:1,scale:4.5,strokeColor:"white",strokeWeight:.5},map:i.map,position:{lat:parseFloat(e.result[o].lat),lng:parseFloat(e.result[o].lng)}});t.push(a),p(a,e.result[o].name)}else swal({title:"Oops!",text:"設定條件內無大眾運輸資料."})},i.addGeoJson=function(e){d("GeoJson"),jQuery.isEmptyObject(e)?swal({title:"Oops!",text:"設定條件內無大眾運輸資料."}):(o.setStyle({fillColor:"#f39c12",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:997}),n.setStyle({fillColor:"#16a085",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:996}),a.setStyle({fillColor:"#c0392b",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:998}),e.result.B&&o.addGeoJson(jQuery.parseJSON(e.result.B)),e.result.M&&n.addGeoJson(jQuery.parseJSON(e.result.M)),e.result.T&&a.addGeoJson(jQuery.parseJSON(e.result.T)),o.setMap(i.map),n.setMap(i.map),a.setMap(i.map))},"function"==typeof define&&define.amd?define(i):window.GMap=i}(),function(e,t){"use strict";var o={domain:"http://207.46.231.69/TripTaipei"};o.getStops=o.domain+"/stops/getStops/#{lng}/#{lat}/#{distance}/#{type}",o.getTripArea=o.domain+"/getTripArea/GeoJson";var n={};n.getStops=function(e,n,a,i,r){t.ajax({url:o.getStops.replace("#{lng}",n).replace("#{lat}",e).replace("#{distance}",a).replace("#{type}",i),jsonp:"callback",dataType:"jsonp",success:function(e){console.log(e),r&&"function"==typeof r&&r(e)},error:function(e){console.log(e)}})},n.getTripArea=function(e,n,a,i,r,l,s,c){t.ajax({url:o.getTripArea,jsonp:"callback",type:"POST",dataType:"jsonp",data:{lat:e,lng:n,walkDistance:a,tripTime:i,weekType:r,startTime:l,transitType:s},success:function(e){console.log(e),c&&"function"==typeof c&&c(e)},error:function(e){console.log(e)}})},"function"==typeof define&&define.amd?define(n):e.TripTaipeiService=n}(window,jQuery);