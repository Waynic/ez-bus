void 0===window.MYAPP&&(window.MYAPP={}),MYAPP.FlatUI=function(e){"use strict";function t(){String.prototype.repeat=function(e){return new[].constructor(Math.round(e)+1).join(this)},$.fn.addSliderSegments=function(){return this.each(function(){var e,t,i,n,a=$(this),o=a.slider("option"),s=(o.max-o.min)/o.step,r=o.orientation,l="";if("vertical"===r){for(e=0,t=s-1;t>e;e+=1)l+='<div class="ui-slider-segment" style="top:'+100/s*e+'%;"></div>';a.prepend(l)}else i=100/s+"%",n='<div class="ui-slider-segment" style="margin-left: '+i+';"></div>',a.prepend(n.repeat(s-1))})},$(document).on("click",'a[href="#fakelink"]',function(e){e.preventDefault()}),n.length>0&&n.slider({min:1,max:4,value:2,orientation:"horizontal",range:"min",slide:function(e,t){var i=t.value*o;n.find(".ui-slider-value:last").text(i+" 分鐘").data("slidervalue",i)}}).addSliderSegments(n.slider("option").max),$(".btn-group").on("click","a",function(){$(this).siblings().removeClass("active").end().addClass("active")}),a.length>0&&a.slider({min:2,max:9,value:6,orientation:"horizontal",range:"min",slide:function(e,t){var i=t.value*s;a.find(".ui-slider-value:last").text(i+" 公尺").data("slidervalue",i)}}).addSliderSegments(a.slider("option").max),$('[data-toggle="select"]').length&&$('[data-toggle="select"]').select2({minimumResultsForSearch:-1}),$('[data-toggle="checkbox"]').length&&$('[data-toggle="checkbox"]').radiocheck(),$('[data-toggle="radio"]').length&&$('[data-toggle="radio"]').radiocheck(),$('[data-toggle="switch"]').length&&$('[data-toggle="switch"]').bootstrapSwitch()}this.$panel=$(e);var i=this.$panel,n=i.find("#slider-trip-time"),a=i.find("#slider-walk"),o=15,s=100;this.$tripTimeSlider=n,this.$walkSlider=a,t()},void 0===window.MYAPP&&(window.MYAPP={}),MYAPP.alert=function(e,t){"use strict";"function"==typeof swal?swal({title:e,text:void 0===t?"":t}):window.alert(e)},function(e){"use strict";function t(){var e=document.getElementById("bgvid");e.pause(),e.addEventListener("ended",function(){e.pause(),e.classList.add("stopfade")})}function i(){console.log(s),s.transitType.length>0?TripTaipeiService.query(s,function(){o.find("#pageBlock").removeClass("hidden")},function(){o.find("#pageBlock").addClass("hidden")},function(e,t){o.find("#bus-area").text(e||"0"),o.find("#bus-service").text(t||"A")}):(MYAPP.alert("請至少選擇一種交通工具"),GMap.clearMap())}function n(e,t){var i=null;return function(){var n=this,a=arguments;window.clearTimeout(i),i=window.setTimeout(function(){e.apply(n,a)},t)}}var a,o=e("#wrapper"),s={walkDistance:600,tripTime:30,startTime:"0800",weekType:1,transitType:"BYTM"};e(function(e){o.removeClass("hidden"),FastClick.attach(document.body);var r=new MYAPP.FlatUI("#sidebar-wrapper");e(".iui-overlay").find("button").on("click",n(function(){t(),GMap.initialize(function(){e(window).resize(function(){google.maps.event.trigger(GMap.map,"resize")}),google.maps.event.addListenerOnce(GMap.map,"idle",function(){s.latitude=GMap.centerMarker.getPosition().lat(),s.longitude=GMap.centerMarker.getPosition().lng()}),google.maps.event.addListenerOnce(GMap.map,"idle",function(){o.find("#overlay").slideUp("slow",function(){o.find("#businfo-panal").removeClass("hidden"),o.find("#menu-toggle").removeClass("hidden"),o.find("#sidebar-wrapper").toggleClass("active")})}),google.maps.event.addListener(GMap.centerMarker,"dragend",function(){s.latitude=GMap.centerMarker.getPosition().lat(),s.longitude=GMap.centerMarker.getPosition().lng(),i()})})},10)),a=r.$panel.find("#weekly .btn").on("click",function(){s.weekType=e(this).data("index"),i()}),a.weekIndex=(new Date).getDay(),s.weekType=0===a.weekIndex?7:a.weekIndex,e(a[s.weekType-1]).addClass("active"),r.$panel.find("#slider-walk").on("slidestop",function(){s.walkDistance=e(this).find(".ui-slider-value:last").data("slidervalue"),GMap.centerCircle.setOptions({radius:s.walkDistance}),i()}),r.$panel.find("#slider-trip-time").on("slidestop",function(){s.tripTime=e(this).find(".ui-slider-value:last").data("slidervalue"),i()}),r.$panel.find('#article-conveyance [data-toggle="switch"]').on("switchChange.bootstrapSwitch",function(t,n){var a=e(t.target),o=s.transitType;n&&-1===o.indexOf(a.val())?o+=a.val():o=o.replace(a.val(),""),s.transitType=o,i()}),r.$panel.find("#timepicker").timepicker({defaultTime:"08:00 AM",disableFocus:!1,showMeridian:!1}).on("hide.timepicker",function(e){var t=e.time.value;e.time.hours<10&&(t="0"+t),s.startTime=t.replace(":",""),i()}),o.find("#menu-toggle, #menu-close").click(function(e){e.preventDefault(),o.find("#sidebar-wrapper").toggleClass("active")})})}(jQuery),function(){"use strict";function e(e,t,i){this.controlUI=document.createElement("div"),this.controlUI.style.backgroundColor="#fff",this.controlUI.style.border="2px solid #fff",this.controlUI.style.borderRadius="3px",this.controlUI.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",this.controlUI.style.cursor="pointer",this.controlUI.style.marginLeft="10px",this.controlUI.style.textAlign="center",this.controlUI.title=t,this.controlText=document.createElement("div"),this.controlText.style.color="rgb(25,25,25)",this.controlText.style.fontSize="14px",this.controlText.style.lineHeight="22px",this.controlText.style.paddingLeft="5px",this.controlText.style.paddingRight="5px",this.controlText.innerHTML='<span class="glyphicon glyphicon-screenshot" aria-hidden="true"></span>',this.controlUI.appendChild(this.controlText),e.appendChild(this.controlUI),i&&"function"==typeof i&&this.controlUI.addEventListener("click",i)}function t(e,t){e.addListener("click",function(){this.infowindow.setOptions({content:"<p>"+t+"</p>"}),this.infowindow.open(this.map,e)}.bind(r))}var i=[],n=new google.maps.Data,a=new google.maps.Data,o=new google.maps.Data,s=new google.maps.Data,r={map:{},centerMarker:{},centerCircle:{},infowindow:{}};r.initialize=function(t){var i=new google.maps.LatLng(25.046281027241395,121.51760685634758),n={zoom:13,disableDefaultUI:!0,scrollwheel:!1,center:i,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_CENTER},styles:[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"},{lightness:33}]},{featureType:"administrative",elementType:"labels",stylers:[{saturation:"-100"}]},{featureType:"administrative",elementType:"labels.text",stylers:[{gamma:"0.75"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{lightness:"-37"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f9f9f9"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{saturation:"-100"},{lightness:"40"},{visibility:"off"}]},{featureType:"landscape.natural",elementType:"labels.text.fill",stylers:[{saturation:"-100"},{lightness:"-37"}]},{featureType:"landscape.natural",elementType:"labels.text.stroke",stylers:[{saturation:"-100"},{lightness:"100"},{weight:"2"}]},{featureType:"landscape.natural",elementType:"labels.icon",stylers:[{saturation:"-100"}]},{featureType:"poi",elementType:"geometry",stylers:[{saturation:"-100"},{lightness:"80"}]},{featureType:"poi",elementType:"labels",stylers:[{saturation:"-100"},{lightness:"0"}]},{featureType:"poi.attraction",elementType:"geometry",stylers:[{lightness:"-4"},{saturation:"-100"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#c5dac6"},{visibility:"on"},{saturation:"-95"},{lightness:"62"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"},{lightness:20}]},{featureType:"road",elementType:"all",stylers:[{lightness:20}]},{featureType:"road",elementType:"labels",stylers:[{saturation:"-100"},{gamma:"1.00"}]},{featureType:"road",elementType:"labels.text",stylers:[{gamma:"0.50"}]},{featureType:"road",elementType:"labels.icon",stylers:[{saturation:"-100"},{gamma:"0.50"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#c5c6c6"},{saturation:"-100"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{lightness:"-13"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{lightness:"0"},{gamma:"1.09"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#e4d7c6"},{saturation:"-100"},{lightness:"47"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{lightness:"-12"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{saturation:"-100"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#fbfaf7"},{lightness:"77"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:"-5"},{saturation:"-100"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{saturation:"-100"},{lightness:"-15"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{lightness:"47"},{saturation:"-100"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#acbcc9"}]},{featureType:"water",elementType:"geometry",stylers:[{saturation:"53"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:"-42"},{saturation:"17"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{lightness:"61"}]}]},a={};this.map=new google.maps.Map(document.getElementById("map-canvas"),n),this.centerMarker=new google.maps.Marker({draggable:!0,position:i,map:this.map,icon:"data:image/png;base64,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"}),this.infowindow=new google.maps.InfoWindow({content:'<p>拖曳我<span class="glyphicon glyphicon-hand-up" aria-hidden="true"></span></p>'}),this.infowindow.open(this.map,this.centerMarker),a.div=document.createElement("div"),a.ui=new e(a.div,"移動到臺北車站",function(){this.centerMarker.setPosition(i),this.centerCircle.setCenter(i),this.map.panTo(i)}.bind(this)),a.div.index=1,this.map.controls[google.maps.ControlPosition.LEFT_CENTER].push(a.div),this.centerCircle=new google.maps.Circle({strokeColor:"#2980B9",strokeOpacity:.8,strokeWeight:2,fillColor:"#3498DB",fillOpacity:.1,map:this.map,center:i,radius:600,zIndex:999}),google.maps.event.addListener(this.centerMarker,"dragstart",function(){this.infowindow.close()}.bind(this)),google.maps.event.addListener(this.centerMarker,"drag",function(){this.centerCircle.setCenter(this.centerMarker.getPosition())}.bind(this)),t&&"function"==typeof t&&t()},r.clearMap=function(e){function t(){var e;if(i){for(e=i.length-1;e>=0;e-=1)i[e].setMap(null);i.length=0}}function r(){n.forEach(function(e){n.remove(e)}),o.forEach(function(e){o.remove(e)}),a.forEach(function(e){a.remove(e)}),s.forEach(function(e){s.remove(e)})}switch(e){case"Stop":t();break;case"GeoJson":r();break;default:t(),r()}},r.addStops=function(e,n){if(this.clearMap("Stop"),e.result.length>0){var a,o,s,r,l;for(a=e.result.length-1;a>=0;a-=1)if(r=e.result[a].type,n.indexOf(r)>-1){switch(r){case"M":o="#2980b9",s="捷運站: ";break;case"B":o="#16a085",s="客運站: ";break;case"T":o="#c0392b",s="火車站: ";break;case"Y":o="#f39c12",s="YouBike: "}l=new google.maps.Marker({icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:o,fillOpacity:1,scale:4.5,strokeColor:"white",strokeWeight:.5},map:this.map,type:r,position:{lat:parseFloat(e.result[a].lat),lng:parseFloat(e.result[a].lng)}}),i.push(l),t(l,s+e.result[a].name)}}}.bind(r),r.addGeoJson=function(e){this.clearMap("GeoJson"),jQuery.isEmptyObject(e)||(a.setStyle({fillColor:"#2980b9",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:991}),n.setStyle({fillColor:"#16a085",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:995}),o.setStyle({fillColor:"#c0392b",fillOpacity:.5,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:.5,zIndex:997}),s.setStyle({fillColor:"#f39c12",fillOpacity:.6,strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:1.2,zIndex:996}),e.result.B&&n.addGeoJson(jQuery.parseJSON(e.result.B)),e.result.M&&a.addGeoJson(jQuery.parseJSON(e.result.M)),e.result.T&&o.addGeoJson(jQuery.parseJSON(e.result.T)),e.result.Y&&s.addGeoJson(jQuery.parseJSON(e.result.Y)),n.setMap(this.map),a.setMap(this.map),o.setMap(this.map),s.setMap(this.map))}.bind(r),"function"==typeof define&&define.amd?define(r):window.GMap=r}(),function(e,t){"use strict";function i(){"function"==typeof swal?swal({title:"Oops!",text:"設定條件內無大眾運輸資料."}):e.alert("設定條件內無大眾運輸資料.")}var n={domain:"http://demo.datarget.com.tw/TripTaipei"},a={};n.getStops=n.domain+"/stops/getStops/#{lng}/#{lat}/#{distance}/#{type}",n.getTripArea=n.domain+"/getTripArea/GeoJson",a.getStops=function(e,a){return t.ajax({url:n.getStops.replace("#{lng}",e.longitude).replace("#{lat}",e.latitude).replace("#{distance}",e.walkDistance).replace("#{type}",e.transitType),jsonp:"callback",dataType:"jsonp",success:function(t){"0"===t.result&&i(),a&&"function"==typeof a&&a(t,e.transitType)},error:function(e){console.error(e)}})},a.getTripArea=function(e,i,a,o){return t.ajax({url:n.getTripArea,jsonp:"callback",dataType:"jsonp",data:{lat:e.latitude,lng:e.longitude,walkDistance:e.walkDistance,tripTime:e.tripTime,weekType:e.weekType,startTime:e.startTime,transitType:e.transitType},beforeSend:i,complete:a,success:function(e){o&&"function"==typeof o&&o(e)},error:function(e){console.error(e)}})},a.query=function(e,i,n,a){var o=this.getStops(e,GMap.addStops),s=this.getTripArea(e,i,n,GMap.addGeoJson);jQuery.when.apply(t,[o,s]).then(function(){a&&"function"==typeof a&&a(s.responseJSON.result.BUSAREA,s.responseJSON.result.BUSSERVICE)})},"function"==typeof define&&define.amd?define(a):e.TripTaipeiService=a}(window,jQuery);